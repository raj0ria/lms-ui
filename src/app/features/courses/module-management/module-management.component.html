<!-- <app-nav-bar></app-nav-bar>

<div class="detail-container">

  <button class="back-btn" (click)="goBack()">
    ‚Üê Back to Course
  </button>

  <div class="course-info">
    <h2>{{ course.title }}</h2>
    <p>{{ course.description }}</p>
  </div>

  <div class="modules-section">
  <div *ngIf="role === 'INSTRUCTOR'" class="section-header">   
    <h3>Modules</h3>
    <button class="add-btn"
      [routerLink]="['/courses', course.id, 'modules', 'create']">
      + Add Module
    </button>
  </div>

  <ng-container *ngIf="modules$ | async as modules">
    
    <div *ngIf="modules.length === 0" class="empty-state">
      No modules added yet.
    </div>

    <ul class="module-list" *ngIf="modules.length > 0">
      <li *ngFor="let m of modules">
        <div class="module-info">
          <div class="module-title">
            {{ m.title }} ({{ m.contentType }})
          </div>

          <div class="module-link">
            <a *ngIf="m.contentType === 'video'" 
              [href]="m.contentUrl" 
              target="_blank">
              ‚ñ∂ Watch Video
            </a>

            <a *ngIf="m.contentType === 'document'" 
              [href]="m.contentUrl" 
              target="_blank">
              üìÑ View Document
            </a>
          </div>
        </div>
        <button *ngIf="role === 'USER'" class="delete-btn" (click)="deleteModule(m.id)">
          Delete
        </button>
      </li>
    </ul>
  </ng-container>
</div>


  <div *ngIf="role === 'USER'" class="enrollments-section">
  <h3>Enrolled Students</h3>

  <ng-container *ngIf="enrollments$ | async as enrollments">

    <div *ngIf="enrollments.length === 0" class="empty-state">
      No students enrolled yet.
    </div>

    <ul *ngIf="enrollments.length > 0" class="enrollment-list">
      <li *ngFor="let e of enrollments">
        <span class="student-name">{{ e.studentName }}</span>
        <span class="progress">
          Progress: {{ e.progress }}%
        </span>
      </li>
    </ul>

  </ng-container>
</div>

</div> -->





<app-nav-bar></app-nav-bar>

<div class="module-container">

  <button class="back-btn" (click)="goBack()">‚Üê Back</button>

  <h2>Course Modules</h2>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    Loading modules...
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && studentModules.length === 0" class="empty-state">
    No modules available for this course.
  </div>

  <!-- Modules List -->
  <div *ngFor="let module of studentModules" class="module-card">

    <div class="module-header">
      <h3>{{ module.name }}</h3>

      <span 
        class="status-badge"
        [ngClass]="{
          'not-started': module.status === EnrollmentStatus.NOT_STARTED,
          'in-progress': module.status === EnrollmentStatus.IN_PROGRESS,
          'completed': module.status === EnrollmentStatus.COMPLETED
        }">
        {{ module.status }}
      </span>
    </div>

    <!-- Material Button -->
    <button 
      class="material-btn"
      (click)="openMaterial(module.materialUrl)">
      ‚ñ∂ Open Material
    </button>

    <!-- Progress Buttons (Only for Students) -->
    <div class="progress-actions">
      <!-- <select [(ngModel)]="module.status"
        (ngModelChange)="updateProgress(module.moduleId, $event)"
        [disabled]="updatingModuleIds.includes(module.moduleId)">
        <option [ngValue]="EnrollmentStatus.NOT_STARTED">Not Started</option>
        <option [ngValue]="EnrollmentStatus.IN_PROGRESS">In Progress</option>
        <option [ngValue]="EnrollmentStatus.COMPLETED">Completed</option>
      </select> -->


      <select
        [ngModel]="module.status"
        (ngModelChange)="updateProgress(module.moduleId, $event)"
        [disabled]="updatingModuleIds.includes(module.moduleId)"
      >

        <!-- Always show current status -->
        <option [ngValue]="module.status">
          {{ module.status }}
        </option>

        <!-- If NOT_STARTED ‚Üí allow only IN_PROGRESS -->
        <option *ngIf="module.status === EnrollmentStatus.NOT_STARTED"
                [ngValue]="EnrollmentStatus.IN_PROGRESS">
          In Progress
        </option>

        <!-- If IN_PROGRESS ‚Üí allow only COMPLETED -->
        <option *ngIf="module.status === EnrollmentStatus.IN_PROGRESS"
                [ngValue]="EnrollmentStatus.COMPLETED">
          Completed
        </option>

      </select>
      <!-- <select
        [(ngModel)]="module.status"
        (change)="updateProgress(module.moduleId, module.status)"
        [disabled]="updatingModuleIds.includes(module.moduleId)"
      >
        <option [ngValue]="EnrollmentStatus.NOT_STARTED">Not Started</option>
        <option [ngValue]="EnrollmentStatus.IN_PROGRESS">In Progress</option>
        <option [ngValue]="EnrollmentStatus.COMPLETED">Completed</option>
      </select> -->

      <!-- Updating Spinner -->
      <span *ngIf="updatingModuleIds.includes(module.moduleId)" class="spinner">
        Updating...
      </span>

    </div>

  </div>

</div>